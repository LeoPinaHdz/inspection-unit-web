<div>
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <a [routerLink]="['/secure/letters']" class="button-back" color="accent" mat-mini-fab>
          <mat-icon>arrow_circle_left</mat-icon>
        </a>
        {{ isEdit ? 'Detalle de oficio' : 'Nueva oficio' }}
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>

      <form [formGroup]="letterForm">
        <div class="form-container">
          <div class="form-cell-3">
            <mat-form-field appearance="outline">
              <mat-label>ID</mat-label>
              <input matInput formControlName="idOficio" appCurrencyMask type="text" />
            </mat-form-field>
          </div>
          <div class="form-cell-3">
            <mat-form-field appearance="outline">
              <mat-label>Folio</mat-label>
              <input matInput formControlName="folio" type="text" />
              <mat-error>
                <error-message nomCampo="Folio"></error-message>
              </mat-error>
            </mat-form-field>
          </div>
          <div class="form-cell-3">
            <mat-form-field>
              <mat-label>Fecha del oficio</mat-label>
              <input matInput formControlName="fOficio" [matDatepicker]="fOficioPicker" required>
              <mat-hint>MM/DD/YYYY</mat-hint>
              <mat-datepicker-toggle matIconSuffix [for]="fOficioPicker"></mat-datepicker-toggle>
              <mat-datepicker #fOficioPicker></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-cell-3">
            <mat-form-field>
              <mat-label>Fecha de presentación</mat-label>
              <input matInput formControlName="fPresentacion" [matDatepicker]="fPresentacionPicker" required>
              <mat-hint>MM/DD/YYYY</mat-hint>
              <mat-datepicker-toggle matIconSuffix [for]="fPresentacionPicker"></mat-datepicker-toggle>
              <mat-datepicker #fPresentacionPicker></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="form-cell-6">
            <mat-form-field appearance="outline">
              <mat-label>Cliente</mat-label>
              <mat-select formControlName="idCliente" required>
                <mat-option *ngFor="let client of clients" [value]="client.idCliente">{{client.nombre}}</mat-option>
              </mat-select>
              <mat-error>
                <error-message nomCampo="Cliente"></error-message>
              </mat-error>
            </mat-form-field>
          </div>
          <div class="form-cell-3">
            <mat-form-field appearance="outline">
              <mat-label>Funcionario</mat-label>
              <mat-select formControlName="idFuncionario" required>
                <mat-option *ngFor="let official of officials"
                  [value]="official.idFuncionario">{{official.nombre}}</mat-option>
              </mat-select>
              <mat-error>
                <error-message nomCampo="Funcionario"></error-message>
              </mat-error>
            </mat-form-field>
          </div>
          <div class="form-cell-3">
            <mat-checkbox formControlName="active" color="primary">Activo</mat-checkbox>
          </div>
          <div class="form-cell-6">
            <mat-form-field appearance="outline">
              <mat-label>Norma oficial</mat-label>
              <mat-select formControlName="idNorma" required>
                <mat-option *ngFor="let standard of standards"
                  [value]="standard.idNorma">{{standard.nombre}}</mat-option>
              </mat-select>
              <mat-error>
                <error-message nomCampo="Norma"></error-message>
              </mat-error>
            </mat-form-field>
          </div>
          <div class="form-cell-6">
            <mat-form-field appearance="outline">
              <mat-label>Observaciones</mat-label>
              <textarea matInput formControlName="observaciones" appCurrencyMask maxlength="255" cdkTextareaAutosize
                #autosize="cdkTextareaAutosize" cdkAutosizeMinRows="1" cdkAutosizeMaxRows="9" required></textarea>
              <mat-error>
                <error-message nomCampo="Observaciones"></error-message>
              </mat-error>
            </mat-form-field>
          </div>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <mat-card>
    <mat-card-header>
      <mat-card-title>
        Detalle
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div *ngIf="letterDetails.length === 0" class="error-message">
        *El oficio debe contener al menos un detalle
      </div>
      <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
        <ng-container matColumnDef="solicitud">
          <th mat-header-cell *matHeaderCellDef>Solicitud</th>
          <td mat-cell *matCellDef="let element"> {{element.solicitud}} </td>
        </ng-container>
        <ng-container matColumnDef="fInspeccion">
          <th mat-header-cell *matHeaderCellDef>Fecha de inspección</th>
          <td mat-cell *matCellDef="let element"> {{element.fInspeccion}} </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    </mat-card-content>
    <mat-card-footer>
      <button *ngIf="letter.idEstatus === 1" (click)="onSubmit()" mat-fab extended>Generar Oficios</button>
    </mat-card-footer>
  </mat-card>
</div>