<mat-card>
  <mat-card-header>
    <mat-card-title>Reportes</mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <form [formGroup]="reportsForm">
      <div class="form-container">        
        <div class="form-cell-3">
          <mat-form-field appearance="outline">
            <mat-label>Reporte</mat-label>
            <mat-select formControlName="idReporte" required>
              <mat-option *ngFor="let report of reportTypes"
                [value]="report.idReporte">{{report.nombre}}</mat-option>
            </mat-select>
            <mat-error>
              <error-message [control]="form.idReporte" nomCampo="Reporte"></error-message>
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-cell-3">
          <mat-form-field appearance="outline">
            <mat-label>Cliente</mat-label>
            <mat-select formControlName="idCliente" placeholder="Cliente" #clientSelect>
              <mat-option>
                <ngx-mat-select-search placeholderLabel="Busca cliente"
                  noEntriesFoundLabel="No se encontraron resultados"
                  formControlName="clientFilter"></ngx-mat-select-search>
              </mat-option>
              <mat-option *ngFor="let client of filteredClients | async" [value]="client.idCliente">
                {{client.nombre}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="form-cell-3">
          <mat-form-field appearance="outline">
            <mat-label>Norma</mat-label>
            <mat-select formControlName="idNorma" required>
              <mat-option *ngFor="let standard of standards"
                [value]="standard.idNorma">{{standard.nombre}}</mat-option>
            </mat-select>
            <mat-error>
              <error-message [control]="form.idNorma" nomCampo="Norma"></error-message>
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-cell-3"><mat-form-field appearance="outline">
            <mat-label>Selecciona rango de fechas</mat-label>
            <mat-date-range-input [rangePicker]="picker" required>
              <input formControlName="fInicio" matStartDate placeholder="Fecha Inicio" required>
              <input formControlName="fFinal" matEndDate placeholder="Fecha Fin" required>
            </mat-date-range-input>
            <mat-hint>MM/DD/YYYY â€“ MM/DD/YYYY</mat-hint>
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-date-range-picker #picker></mat-date-range-picker>
            <mat-error>
              <error-message [control]="form.Fecha" nomCampo="Selecciona rango de fechas"></error-message>
            </mat-error>
          </mat-form-field></div>
      </div>
    </form>

  </mat-card-content>
  <mat-card-footer>
    <button matTooltip="Consultar" (click)="onSubmit()" mat-fab extended color="primary" class="float-left"> Consultar
    </button>
    <button *ngIf="currentReport" matTooltip="Limpiar" (click)="clear()" class="clear float-left" mat-fab extended>
      Limpiar </button>
    <button *ngIf="currentReport" matTooltip="Descargar Excel" (click)="download()" class="float-right" mat-fab
      extended>
      <mat-icon>get_app</mat-icon> Descargar Excel
    </button>
  </mat-card-footer>
</mat-card>

<mat-card>
  <mat-card-content>
    <table class="preview-table">
      <thead>
        <th *ngFor="let header of headers">{{header}}</th>
      </thead>
      <tbody>
        <tr *ngFor="let row of values">
          <td *ngFor="let val of row">{{val}}</td>
        </tr>
        <tr class="font-700" *ngIf="totalsRow.length > 0">
          <td *ngFor="let total of totalsRow">{{total}}</td>
        </tr>
      </tbody>
    </table>
  </mat-card-content>
</mat-card>